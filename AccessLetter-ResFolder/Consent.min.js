function init(){var e=getParameterByName("identity");if(0!==e.length){var t=Base64.decode(e);itemID=t.split("=")[1],$("#btn_Submit").on("click",SubmitData)}else console.log("Record does not exists")}function getParameterByName(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),a=t.exec(location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))}function SubmitData(){var e=$("#txt_Name"),t=$("#txt_Email"),a=$("#txt_Company");if(0==e.val().length||0==t.val().length||0==a.val().length)return void alert("Empty Field");if(!validateEmail(t.val()))return void alert("Invalid Email");$("#btn_Submit").attr("Value","Accepting...");var n=new SP.ClientContext.get_current,o=n.get_web().get_lists().getByTitle("Consent").getItemById(itemID);o.set_item("SName",$("#txt_Name").val()),o.set_item("SEmail",$("#txt_Email").val()),o.set_item("SCompany",$("#txt_Company").val()),o.set_item("Consent",!0),o.set_item("ConsentOn",new Date),o.set_item("ManagerInformed",!1),o.update(),n.executeQueryAsync(function(){$("#btn_Submit").attr("Value","Accepted"),$("#btn_Submit").attr("disabled","true"),$("#messageStatus").html("<img src='logo_overview.png' alt='bainlogo'><br><br>Thank you for accepting Bain & Company's terms of access. Your information is being processed and you should receive the report from the project manager shortly.<br><br> Please remember that the terms of access only allow you to share the report internally within your organization and its affiliates so if you want to pass the Materials to someone in another organization, they will also need to accept Bain & Company's terms of access before they can access the Materials."),$(".container-fluid").css("display","none");var e=document.getElementById("messageStatus");e.scrollTop},function(e,t){if("Item does not exist. It may have been deleted by another user."===t.get_message()){var a=new SP.CamlQuery;a.set_viewXml("<View><Query><Where><Eq><FieldRef Name='Title' /><Value Type='Text'>"+itemID+"</Value></Eq></Where></Query></View>");var o=n.get_web().get_lists().getByTitle("VendorComebackRequests").getItems(a);n.load(o,"Include(Title)"),n.executeQueryAsync(function(){if(0===o.get_count()){var e=new SP.ListItemCreationInformation,t=n.get_web().get_lists().getByTitle("VendorComebackRequests").addItem(e);t.set_item("Title",itemID),t.set_item("SName",$("#txt_Name").val()),t.set_item("SEmail",$("#txt_Email").val()),t.set_item("SCompany",$("#txt_Company").val()),t.set_item("ConsentOn",new Date),t.update(),n.executeQueryAsync(function(){$(".container-fluid").css("display","none"),$("#messageStatus").html("<img src='logo_overview.png' alt='bainlogo'><br><br>Thank you for accepting Bain & Company's terms of access. Your information is being processed and you should receive the report from the project manager shortly.<br><br> Please remember that the terms of access only allow you to share the report internally within your organization and its affiliates so if you want to pass the Materials to someone in another organization, they will also need to accept Bain & Company's terms of access before they can access the Materials.");var e=document.getElementById("messageStatus");e.scrollTop},function(e,t){alert(t.get_message()+" ERROR in adding Vendor comeback request"),$("#btn_Submit").attr("Value","Accepted"),$("#btn_Submit").attr("disabled","true")})}else if(1===o.get_count()){var a=o.get_item(0);a.set_item("SName",$("#txt_Name").val()),a.set_item("SEmail",$("#txt_Email").val()),a.set_item("SCompany",$("#txt_Company").val()),a.set_item("ConsentOn",new Date),a.update(),n.executeQueryAsync(function(){$(".container-fluid").css("display","none"),$("#messageStatus").html("<img src='logo_overview.png' alt='bainlogo'><br><br>Thank you for accepting Bain & Company's terms of access. Your information is being processed and you should receive the report from the project manager shortly.<br><br> Please remember that the terms of access only allow you to share the report internally within your organization and its affiliates so if you want to pass the Materials to someone in another organization, they will also need to accept Bain & Company's terms of access before they can access the Materials.");var e=document.getElementById("messageStatus");e.scrollTop},function(e,t){alert(t.get_message()+" ERROR in updating Vendor comeback request"),$("#btn_Submit").attr("Value","Accepted"),$("#btn_Submit").attr("disabled","true")})}},function(e,t){alert(t.get_message()+" ERROR connecting to VendorComebackRequests"),$("#btn_Submit").attr("Value","Accepted"),$("#btn_Submit").attr("disabled","true")})}else $("#messageStatus").html(t.get_message()),$("#btn_Submit").attr("Value","Accepted"),$("#btn_Submit").attr("disabled","true")})}function validateEmail(e){var t=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;return t.test(e)}window.addEventListener("DOMContentLoaded",function(){SP.SOD.executeFunc("sp.js","SP.ClientContext",init)});var itemID=null,cItem=null,regex=new RegExp("^[a-zA-Z0-9@_.+-]+$");